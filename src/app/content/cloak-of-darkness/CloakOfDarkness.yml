---
name: Cloak of Darkness
version: 0.9
authors: "[Matt Eland](http://www.matteland.com)"
description:
  |
  A short demo based on [Roger Firth's specification](http://www.firthworks.com/roger/cloak/) to
  compare various Interactive Fiction development languages.
max score: 2
icon: fa-bookmark-o
introText:
- |
  Hurrying through the rainswept November night, you're glad to see the bright lights of the Opera
  House. It's surprising that there aren't more people about but, hey, what *do* you expect in a
  cheap demo game...?
# IDs are important here for YAML to have accurate anchors since they must be declared above refs
ids:
- &aPlayer yourself
- &rFoyer foyer
- &rBar bar
- &rCloakroom cloakroom
- &iCloak cloak
- &oMessage message
- &oHook hook
rooms:
# Foyer
- id: *rFoyer
  name: Foyer of the Opera House
  description:
  - |
    You are standing in a spacious hall, splendidly decorated in red and gold, with glittering
    chandeliers overhead. The entrance from the street is to the north, and there are doorways
    south and west.
  nav:
    north:
      goMessage: You've only just arrived, and besides, the weather outside seems to be getting worse.
    west: *rCloakroom
    south: *rBar
# Cloakroom
- id: *rCloakroom
  name: Cloakroom
  description:
  - |
    The walls of this small room were clearly once lined with hooks, though now only one remains.
    The exit is a door to the east.
  nav:
    east: *rFoyer
  objects:
  # The hook for hanging the cloak
  - id: *oHook
    name: small brass hook
    aliases:
      nouns:
      - Peg
    emptyDescription: It's just a small brass hook screwed to the wall.
    description: It's just a small brass hook with a {contents} hanging on it.
    allowHang: true
    maxContents: 1
# Bar
- id: *rBar
  name: Foyer Bar
  description:
  - |
    The bar, much rougher than you'd have guessed after the opulence of the foyer to the north, is
    completely empty. There seems to be some sort of message scrawled in the sawdust on the floor.
  nav:
    north: *rFoyer
    isDark: true # This is updated onBarEnter based on presence / absence of the cloak
    onEnter:
    - invoke: onBarEnter # Update whether or not we're dark
    darkName: Darkness
    darkDescription: It is pitch dark, and you can't see a thing.
    onAction:
    - invoke: onBarAction # Track blunders
    contents:
    # Scrawled Message
    - id: *oMessage
      name: scrawled message
      describeWithRoom: false
      aliases:
        nouns:
        - Writing
        - Sawdust
        - Words
        - Word
        - Note
        - Floor
        - Ground
        adjectives:
        - Written
        - Dusty
      description:
      - invoke: onReadMessage # This will trigger the game end.
actors:
# The player
- id: *aPlayer
  name: yourself
  startRoom: *rFoyer
  isPlayer: true
  contents:
  # The Titular Cloak of Darkness
  - id: *iCloak
    name: black velvet cloak
    description:
      - |
        The velvet cloak almost seems to have darkness woven into its very fabric. Everything about
        it is darker than it should be.
    inRoomDescription: A dark black velvet cloak rests in a heap on the floor.
    wearable: true
    isWorn: true
    previewDrop: # Don't allow the user to drop the cloak if they're not in the cloakroom
    - invoke: previewCloakDrop
# Resource Strings used by different operations
strings:
- barBlunder: Blundering around in the dark isn't a good idea!
- cloakDropFail: This isn't the best place to leave a smart cloak lying around.
- messageWin: The message, neatly marked in the sawdust, reads...
- messageLose: The message has been carelessly trampled, making it difficult to read. You can just distinguish the words...
